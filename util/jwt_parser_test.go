package util

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestMS(t *testing.T) {
	m := MicroSoftJwtParser{}

	token := `eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IlNQODlCMFZZV1NmZmJuT2N2aGtZQm1QZG8zTSJ9.eyJ2ZXIiOiIyLjAiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vOTE4ODA0MGQtNmM2Ny00YzViLWIxMTItMzZhMzA0YjY2ZGFkL3YyLjAiLCJzdWIiOiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFCNG1Oa092YzNOQ0M0TEtyaU11RXRzIiwiYXVkIjoiMWUwNDBhOTUtYmVkMy00NmIzLWI1NmQtZjc1ZmFmZDM2ZWM4IiwiZXhwIjoxNzE2NTcyMTY5LCJpYXQiOjE3MTY0ODU0NjksIm5iZiI6MTcxNjQ4NTQ2OSwibmFtZSI6Ik1PSVogSEFTU0FOIC0gQ0YiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJtb2l6bTEzQGdtYWlsLmNvbSIsIm9pZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC01N2NlLWQwMDJmMTJmZjFkYyIsInRpZCI6IjkxODgwNDBkLTZjNjctNGM1Yi1iMTEyLTM2YTMwNGI2NmRhZCIsIm5vbmNlIjoiMDE4ZmE2ODUtNGVmZS03MDA1LWFiNjgtOGU0ZGI2NDljODk5IiwiYWlvIjoiRGlTOXE5RndJdEhwZVRvIXlKamFGV0VNZHRGNnZoQnMzMHY4cTUzQnF4YmFIbHFNUHJ4UUlNb0dNcVchTEtXWXJEb0w2bWNzTVBnRUJkV0E5R3htd0NwVjJpNElPYWJoVEV4T2J2RDBFQ0RNalNGMFVWMDV5aVhTVVZLdVFoRGpQMkM4Q3ZQVE0yaXVVQlNOSENWNFEhTTFFTFpjM3lBeTJmaEZTVDlkVTBTbiJ9.iCuGpuBi_0qSR68B5OVL6tI6qoCLR__sLxgNfavtv2pkLVIW1_Dp_G6v3kpvuj6YAkT0nOuqgKpXm5w12Vr_c975qm692_XbnAB1yX2TjXu-tk-yUnhWi6da9WofC_hVFv_m-K1lCg_cx0J53c78odFF7w0PV2kaCSeKjZJkjg_zXSJQBrT_XxnioixzWlM5H6CzyxJAGFcMdLGHs307l6Ij9s7fOyzK5jJP02kZ-akMG52sz4mt-M62NIhupE_WvCSo4NqYXRK9ETaqjUEJUlcmCByUIfixX3NXzadVEHT5jfj6Cehc_c28YOv4wd6UkTx0iXRLqv5VNBUdTWGF5Q`
	ret, err := m.TokenToPayload(token)
	assert.Nil(t, err)
	assert.NotEmpty(t, ret.Username)
}
